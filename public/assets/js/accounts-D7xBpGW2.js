import{p as i,q as J,b as c,M as e}from"./index-DfK_AuQa.js";import{a as S}from"./format-YoKwq1Pz.js";import{u as N}from"./useCommonStore-Cm69_3M8.js";const O=a=>i.request("get","/admin/account",{params:a}),Q=a=>i.request("post","/admin/account",{data:a}),q=a=>i.request("patch","/admin/account",{data:a}),U=a=>i.request("post","/admin/account/update_info",{data:a}),V=a=>i.request("post","/admin/account/update_data",{data:a}),W=a=>i.request("delete","/admin/account",{data:a}),X=a=>i.request("post","/admin/account/check_ban_status",{data:a}),ce=a=>i.request("post","/admin/account/get_cid_info",{data:a}),ne=J("accounts",()=>{const[a,$,P,u]=N(O,()=>{t.value=[]}),t=c([]),b=o=>{t.value=o},I=async()=>{if(t.value.length===0)return e.error("请选择账号");await U({id:t.value}),e.success("更新成功"),await u()},R=async()=>{if(t.value.length===0)return e.error("请选择账号");await W({id:t.value}),t.value=[],e.success("删除成功"),await u()},_=c(!1),k=c({id:[],switch:!1}),C=()=>_.value=!0,x=()=>_.value=!1,B=async()=>{if(t.value.length===0)return e.error("请选择账号");await q({...k.value,id:t.value}),e.success("更新成功"),await u()},v=c(!1),E=()=>v.value=!0,M=()=>v.value=!1,m=c({id:[],prov:null}),T=async()=>{if(t.value.length===0)return e.error("请选择账号");await q({...m.value,id:t.value}),e.success("更新省份成功"),await u()},f=c(!1),K=()=>f.value=!0,L=async()=>f.value=!1,d=c("cookie"),w=c({cookie:"",cid:0,refresh_token:"",access_token:"",device_id:"",url:"",surl:"",pwd:"",dir:"",save_cookie:"",download_cookie:"",dlink_cookie:""}),j=async()=>{const o={account_type:d.value,account_data:[]},{cookie:s,refresh_token:A,surl:r,pwd:n,dir:h,save_cookie:l,download_cookie:F,dlink_cookie:D,cid:y,access_token:G,device_id:H}=w.value;d.value==="cookie"?o.account_data=[{cookie:s}]:d.value==="enterprise_cookie"?o.account_data=[{cookie:s,dlink_cookie:D,cid:y}]:d.value==="open_platform"?o.account_data=[{refresh_token:A}]:d.value==="open_platform_nas"?o.account_data=[{access_token:G,device_id:H,dlink_cookie:D}]:d.value==="download_ticket"&&(o.account_data=[{surl:r,pwd:n,dir:h,save_cookie:l,download_cookie:F,cid:y}]),await Q(o),e.success("插入成功~"),w.value={cookie:"",refresh_token:"",access_token:"",device_id:"",cid:0,url:"",surl:"",pwd:"",dir:"",save_cookie:"",download_cookie:"",dlink_cookie:""},await u()},z=async(o,s)=>{o.stopPropagation(),(await X({id:[s]})).data.forEach(r=>{r.status.forEach((n,h)=>{let l="账号";if(r.account_type==="download_ticket"&&(l=h===0?"企业账号":"普通账号"),n.code!==200)return e.error(`${l}(${r.id})${n.message}`);if(!n.data.ban_status)return e.success(`${l}(${r.id})未被封禁`);e.warning(`${l}(${r.id})已被封禁`),e.warning(`原因: ${n.data.ban_reason}`),e.warning(`消息: ${n.data.ban_msg}`),e.warning(`开始时间: ${S(n.data.start_time)}`),e.warning(`结束时间: ${S(n.data.end_time)}`)})})},p=c({id:[],account_type:"cookie",account_data:{cookie:"",vip_type:"普通用户",expires_at:""}}),g=c(!1);return{pagination:$,selectReq:a,accountList:P,getAccounts:u,selectedRowKeys:t,handleSelectChange:b,updateInfoSelection:I,deleteSelection:R,isUpdateSwitch:_,updateSwitchReq:k,showUpdateSwitchDialog:C,hideUpdateSwitchDialog:x,updateSwitch:B,isUpdateProvDialog:v,updateProvReq:m,showUpdateProvDialog:E,hideUpdateProvDialog:M,updateProvSelection:T,isAddAccount:f,addAccountType:d,addAccountInput:w,showAddAccountDialog:K,hideAddAccountDialog:L,addAccount:j,checkAccountBanStatus:z,updateAccountDataInfo:p,isUpdatingAccountData:g,showUpdateAccountDataDialog:(o,s)=>{o.stopPropagation(),p.value={id:[s.id],account_type:s.account_type,account_data:s.account_data},g.value=!0},hideUpdateAccountDataDialog:()=>{g.value=!1},updateAccountData:async()=>{await V(p.value),e.success("编辑账户信息成功"),await U({id:p.value.id}),e.success("更新账户信息成功"),await u()}}});export{ce as g,ne as u};
