import{be as W,bf as D,ak as X,b as T,c as C,w as Y,a0 as L,Y as G}from"./index-GGcywzjB.js";import{b as q}from"./useResizeObserver-D0O-ohFK.js";import{d as J}from"./debounce-DVjBH-4D.js";function K(t,n){return t>n}function P(t,n){return t<n}function M(t,n,l){for(var o=-1,s=t.length;++o<s;){var x=t[o],c=n(x);if(c!=null&&(S===void 0?c===c&&!W(c):l(c,S)))var S=c,f=x}return f}function Q(t){return t&&t.length?M(t,D,K):void 0}function Z(t,n){for(var l,o=-1,s=t.length;++o<s;){var x=n(t[o]);x!==void 0&&(l=l===void 0?x:l+x)}return l}function ee(t){return t&&t.length?M(t,D,P):void 0}function H(t){return t&&t.length?Z(t,D):0}var le="Expected a function";function ae(t,n,l){var o=!0,s=!0;if(typeof t!="function")throw new TypeError(le);return X(l)&&(o="leading"in l?!!l.leading:o,s="trailing"in l?!!l.trailing:s),J(t,n,{leading:o,maxWait:n,trailing:s})}/**
 * tdesign v1.11.5
 * (c) 2025 tdesign
 * @license MIT
 */var re=function(n,l){var o,s,x=T([]),c=T((((o=l.value.data)===null||o===void 0?void 0:o.length)||0)*(((s=l.value.scroll)===null||s===void 0?void 0:s.rowHeight)||50)),S=T(0),f=[],I=T(0),$=T(0),_=T([0,15]),v=C(function(){var i,e,a=l.value.scroll;return a?{bufferSize:a.bufferSize||10,isFixedRowHeight:(i=a.isFixedRowHeight)!==null&&i!==void 0?i:!1,rowHeight:a.rowHeight||47,threshold:a.threshold||100,type:a.type,fixedRows:(e=a.fixedRows)!==null&&e!==void 0?e:[0,0]}:{}}),w=C(function(){var i=l.value.data;return v.value.type==="virtual"&&v.value.threshold<i.length});function O(){for(var i,e,a=(i=(e=n.value)===null||e===void 0?void 0:e.scrollTop)!==null&&i!==void 0?i:0,r=v.value.fixedRows[0],u=[],b=0,d=-1,h=-1,R=0,g=0,E=l.value.data.length;g<E;g++){var m,z=(m=f[g])!==null&&m!==void 0?m:v.value.rowHeight;if(R=R+z,R>a&&d===-1&&(d=g,d-v.value.bufferSize>0&&(b=R-z-H(u))),d===-1&&(u.push(z),u.length>v.value.bufferSize&&u.shift()),h===-1&&(R>I.value+a||g===l.value.data.length-1)&&(h=g),d!==-1&&h!==-1)break}var F=Q([d-v.value.bufferSize,0]),N=ee([h+v.value.bufferSize,l.value.data.length]),U=H(f.slice(0,Math.min(F,r)));return{startIndex:F,endIndex:N,translateY:b-U}}var V=ae(function(){var i=O(),e=i.startIndex,a=i.endIndex,r=i.translateY,u=v.value.fixedRows,b=L(u,2),d=b[0],h=b[1],R=d?l.value.data.slice(0,d):[];d&&e<d&&(R=R.slice(0,e));var g=h?l.value.data.slice(l.value.data.length-h):[],E=a-l.value.data.length+1+(h??0);h&&E>0&&(g=g.slice(E)),_.value.join()!==[e,a].join()&&e>=0&&(c.value=r,x.value=R.concat(l.value.data.slice(e,a),g),_.value=[e,a])},100),p=function(e){var a;if(!(!w.value||!e||v.value.isFixedRowHeight||!n.value)){var r=((a=e.ref.value)===null||a===void 0?void 0:a.getBoundingClientRect().height)||v.value.rowHeight,u=e.data.VIRTUAL_SCROLL_INDEX;if(f[u]!==r){var b=r-f[u];f[u]=r,S.value=S.value+b}}},j=function(){w.value&&V()},k=function(e){var a=L(e,1),r=a[0].contentRect;if(!l.value.preventResizeRefresh){var u=16;Math.abs(r.width-$.value)>u&&n.value&&(n.value.scrollTop=0,c.value=0),$.value=r.width,I.value=r.height}},y=function(e){e.forEach(function(a,r){a.VIRTUAL_SCROLL_INDEX=r})},A=function(e){var a=e.index,r=e.top,u=r===void 0?0:r,b=e.behavior,d=H(f.slice(0,a+1))-u;n.value.scrollTo({top:d,behavior:b||"auto"})},B=function(e){if(A(e),!v.value.isFixedRowHeight)var a,r=(a=e.time)!==null&&a!==void 0?a:60,u=setTimeout(function(){A(e),clearTimeout(u)},r)};return q(C(function(){return w.value?n.value:void 0}),k),Y(function(){return[G(l.value.data),v.value,w.value,n.value]},function(){if(!(!w.value||!n.value)){var i=l.value.data;if(y(i),I.value=n.value.getBoundingClientRect().height,f.length!==l.value.data.length){var e=Array.from(f);e.length=l.value.data.length,e.fill(v.value.rowHeight||47),f=e}S.value=H(f),_.value=[0,0],V()}},{immediate:!0}),Y(function(){return I.value},function(){V()}),{visibleData:x,translateY:c,scrollHeight:S,isVirtualScroll:w,handleScroll:j,handleRowMounted:p,scrollToElement:B}};export{ae as t,re as u};
